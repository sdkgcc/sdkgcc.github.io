function addEvent(e,t,n){return e?.attachEvent?e.attachEvent("on"+t,n):e?.addEventListener(t,n,!1)}const getElement=e=>document.getElementById(e),getElements=e=>document.querySelectorAll(e);function recalcLogotypeWidth(){const e=getElement("logotype"),t=getElement("logotype__text");e?.setAttribute("width",`${t.getBoundingClientRect().width}px`)}function adaptViewport(){if(document.fonts.ready.then(()=>{recalcLogotypeWidth()}),window.innerWidth<640){{getElement("has-search")?.setAttribute("open","open"),getElement("has-search")?.removeAttribute("name"),getElement("has-more-menu")?.setAttribute("open","open");let t=getElement("slide-1");if(t){function e(){let e=getElement("to-top");document.body.scrollTop>100||document.documentElement.scrollTop>100?e.classList.remove("to-content-top"):e.classList.add("to-content-top")}e(),addEvent(window,"scroll",e)}}}else getElement("top-nav")?.setAttribute("open","open"),addEvent(visualViewport,"resize",adaptViewport)}addEvent(window,"DOMContentLoaded",adaptViewport);const collapseParentNode=getElements(".js-cpn"),collapseGrandParentNode=getElements(".js-cgpn"),detailsElements=getElements("details.js-details");collapseParentNode.forEach(e=>{const t=()=>e.parentNode?.removeAttribute("open");addEvent(e,"click",t)}),collapseGrandParentNode.forEach(e=>{const t=()=>e.parentNode?.parentNode?.removeAttribute("open");addEvent(e,"click",t)}),window.innerWidth>640&&detailsElements.forEach(e=>{const t=t=>{const n=e.getAttribute("name");n&&getElements(`details.js-details[name="${n}"]`).forEach(t=>{t!==e&&t.hasAttribute("open")&&t.removeAttribute("open")})};addEvent(e,"click",t)}),typeof navigatorShare!="undefined"&&(getElement("navigatorShare")?.setAttribute("href","javascript:navigator.share({title: document.title, url: window.location.href})"),location.protocol==="https:"&&getElement("copyPermalink")?.removeAttribute("class")),getElement("print-button")?.removeAttribute("class"),getElement("back")?.removeAttribute("class");const date=new Date;if(typeof mastodonInstance!="undefined"){getElement("has-mastodon").className="active";const e=()=>{mastodonTitle.disabled=!0,mastodonPermalink.disabled=!0,mastodonText.disabled=!1,mastodon?.setAttribute("action",`${mastodonInstance.value}/share`)};if(addEvent(mastodonInstance,"input",e),typeof QRCode!="undefined"){getElement("colophon").removeAttribute("style"),qr?.appendChild(QRCode({msg:window.location.href,ecl:"M",pal:["#000","#fff"],pad:2,dim:96}));const e=date.toISOString(),t=getElement("time-stamp");t.innerHTML=e,t?.setAttribute("datetime",e)}}const hour=date.getHours(),isDaytime=hour>6&&hour<21;function toggleNightElements(e){const t=["grain","dwclock"];t.forEach(t=>{const n=getElement(t);n?.[e?"setAttribute":"removeAttribute"]("hidden","hidden")})}if(isDaytime)toggleNightElements(!0);else{toggleNightElements(!1);let e;function updateClock(){const e=date.getMinutes(),t=date.getSeconds(),n=e/60*360+t/60*6,s=hour/12*360+e/60*30,o=["transform","webkitTransform","mozTransform","msTransform","oTransform"],i={"#min":n,"#hour":s};Object.entries(i).forEach(([e,t])=>{const n=document.querySelector(e);o.forEach(e=>{n.style[e]=`rotate(${t}deg)`})})}updateClock(),e=setInterval(updateClock,1e4)}addEvent(window,"beforeprint",function(){getElements('[name="redaction-history"]')?.forEach(e=>{e.setAttribute("open","open")})});const bodySty=document.body,htmlSty=document.documentElement.style;getElement("a11y").disabled=!1;const closeA11yConsole=()=>getElement("has-a11y").removeAttribute("open"),matchMediaColor=()=>{lightSwitch.checked=window.matchMedia("(prefers-color-scheme: dark)").matches,window.matchMedia("(prefers-contrast: more)").matches?moreContrast.checked=!0:window.matchMedia("(prefers-contrast: less)").matches?lessContrast.checked=!0:defaultContrast.checked=!0};function setColor(){const t={light:{default:"--off: #000; --fg: var(--fg-light); --mid: var(--midtone); --ac: var(--ac-light); --bg: var(--bg-light);",less:"--off: #000; --fg: var(--fg-light-less); --mid: var(--midtone-less); --ac: var(--ac-light-less); --bg: var(--bg-light-less);",more:"--off: #000; --fg: var(--fg-light-more); --mid: var(--midtone-more); --ac: var(--ac-light-more); --bg: var(--bg-light-more); --border: 1pt solid var(--fg); --bound: var(--border);"},dark:{default:"--off: #fff; --fg: var(--fg-dark); --mid: var(--midtone); --ac: var(--ac-dark); --bg: var(--bg-dark);",less:"--off: #fff; --fg: var(--fg-dark-less); --mid: var(--midtone-less); --ac: var(--ac-dark-less); --bg: var(--bg-dark-less);",more:"--off: #fff; --fg: var(--fg-dark-more); --mid: var(--midtone-more); --ac: var(--ac-dark-more); --bg: var(--bg-dark-more); --border: 1pt solid var(--fg); --bound: var(--border);"}},n=lightSwitch.checked?"dark":"light",e=getElement("logomark--dark");if(e){const t=getElement("logomark");t.style.display=lightSwitch.checked?"none":"inline-block",e.style.display=lightSwitch.checked?"inline-block":"none"}const s=lessContrast.checked?"less":moreContrast.checked?"more":"default";bodySty.setAttribute("style",t[n][s])}if(addEvent(document,"DOMContentLoaded",()=>{setTimeout(()=>htmlSty.setProperty("--flashGuard","1s ease-in 0.1s"),99)}),isPage=getElement("page"),isPage){getElement("focusMode").className="",defocusAuxElement.checked=!1;function focusMode(){defocusAuxElement.checked?document.body.classList.add("focus"):document.body.classList.remove("focus")}}addEvent(document,"keydown",e=>{e.key==="Tab"&&document.body.classList.add("keydown"),e.key==="Escape"&&document.body.classList.remove("keydown")});function setColorPalette(){document.body.className=colorPalette.value}function useOpenDyslexic(){OpenDyslexic.checked?(htmlSty.setProperty("--rm","OpenDyslexic"),htmlSty.setProperty("--sf","OpenDyslexic")):(htmlSty.removeProperty("--rm"),htmlSty.removeProperty("--sf")),recalcLogotypeWidth()}function setFontSize(){fontSizeState.value=fontSize.value,htmlSty.setProperty("--fontScale",fontSize.value/10)}function setStretch(){baselineStretchState.value=baselineStretch.value,htmlSty.setProperty("--baselineStretch",baselineStretch.value)}function hasLocalStorage(){try{return localStorage.is="enable",localStorage.removeItem("is"),!0}catch{return defaultContrast.checked=!0,getElement("noLocalStorage").className="",!1}}if(hasLocalStorage()){getElement("a11y-menu").className="",saveButton.disabled=!1,resetButton.disabled=!1;function resetA11y(){localStorage.clear(),matchMediaColor(),colorPalette.reset,fontSize.value="",baselineStretch.value="",OpenDyslexic.checked=!1,setTimeout(()=>window.location.reload(),100)}function saveA11y(){setTimeout(()=>closeA11yConsole(),618),localStorage.scheme=lightSwitch.checked?"light":"dark",defaultContrast.checked&&(localStorage.contrast="default"),lessContrast.checked&&(localStorage.contrast="less"),moreContrast.checked&&(localStorage.contrast="more"),localStorage.colorPalette=colorPalette.value,localStorage.font=OpenDyslexic.checked?"OpenDyslexic":"",localStorage.fontSize=fontSize.value,localStorage.stretchSize=baselineStretch.value}!localStorage.getItem("scheme")&&!localStorage.getItem("contrast")?matchMediaColor():(lightSwitch.checked=localStorage.scheme!=="dark",localStorage.contrast==="more"?moreContrast.checked=!0:localStorage.contrast==="less"?lessContrast.checked=!0:defaultContrast.checked=!0,setColor()),localStorage.getItem("colorPalette")&&(colorPalette.value=localStorage.colorPalette,setColorPalette()),localStorage.font==="OpenDyslexic"&&(OpenDyslexic.setAttribute("checked","checked"),useOpenDyslexic()),localStorage.getItem("fontSize")&&(fontSize.value=localStorage.fontSize,setFontSize()),localStorage.getItem("stretchSize")&&(baselineStretch.value=localStorage.stretchSize,setStretch())}getElement("useBionRead").className="",bionReadSwitch.checked=!1;function bionRead(){const t=getElement("content"),e=getElement("bionReadSnapshot");if(!t||!e){console.error("Required elements not found");return}if(bionReadSwitch.checked){e.innerHTML=t.innerHTML;const n=getElements("[data-bionRead-safe]");n.forEach(e=>{const t=e.querySelectorAll("h1, h2, h3, h4, h5, p, a, li, blockquote");t.forEach(e=>{const t=e.innerText.split(" "),n=t.map(e=>{const t=e.length;if(t===1)return`<b class=k>${e}</b>`;const n=Math.ceil(t/2);return e.split("").map((e,t)=>t<n?`<b k>${e}</b>`:e).join("")});e.innerHTML=n.join(" ")})}),htmlSty.setProperty("--fg",lightSwitch.checked?"#333":"#ccc"),htmlSty.setProperty("--bion","0.028em")}else t.innerHTML=e.innerHTML,e.innerHTML="",htmlSty.removeProperty("--fg"),htmlSty.removeProperty("--bion"),setColor()}